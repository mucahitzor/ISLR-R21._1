linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat, data[-42,374,375,413,415,ff),]) %>%
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat, data[-c(142,374,375,413,415,ff),]) %>%
pluck("fit") %>%
summary()
slr_res %>%
augment() %>% mutate(id = 1:506) %>%
filter(.hat > 0.02) %>%
select(id, .std.resid,.hat) %>%
print() -> highlevgs
slr_res %>%
augment() %>%
mutate(id = 1:506) %>%
ggplot() + aes(y =.std.resid, x = .fitted, color = ifelse(abs(.std.resid) > 3, F,T)) + geom_point(size =2, show.legend = F) + geom_hline(yintercept = 0, linetype = "dashed") +
ggrepel::geom_text_repel(aes(label = ifelse(abs(.std.resid) > 3,id,"")), max.overlaps = 100, show.legend = F) + scale_color_ipsum()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat, data[otliers,]) %>%
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat, data[-outliers,]) %>%
pluck("fit") %>%
summary()
outliers
outliers
pull("id") -> outliers
outliers
slr_res %>%
augment() %>%
mutate(id = 1:506) %>%
filter(abs(.std.resid) > 3) %>%
select(id,.std.resid) %>% print() %>%
pull("id") -> outliers
slr_res %>%
augment() %>% mutate(id = 1:506) %>%
filter(.hat > 0.02) %>%
select(id, .std.resid,.hat) %>%
print() -> highlevgs
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat, data[-outliers,]) %>%
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat, data[-highlevgs,]) %>%
pluck("fit") %>%
summary()
slr_res %>%
augment() %>% mutate(id = 1:506) %>%
filter(.hat > 0.02) %>%
select(id, .std.resid,.hat) %>%
print() %>% pull("id") -> highlevgs
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat, data[-highlevgs,]) %>%
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat, data[-outliers,]) %>%
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat, data[-c(outliers,highlevgs),]) %>%
pluck("fit") %>%
summary()
slr_res %>% summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat, data[-c(outliers,highlevgs),]) %>%
pluck("fit") %>%
summary()
slr_res %>% summary() %>% print()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat, data[-c(outliers,highlevgs),]) %>%
pluck("fit") %>%
summary()
slr_res %>% summary() %>% print()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat, data[-c(outliers,highlevgs),]) %>%
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat + age, dat)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat + age, data)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat + age, data) %>%
pluck("fit")
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat + age, data) %>%
pluck("fit") -> mlr
mlr %>% summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat + age, data[-c(outliers,highlevgs),]) %>%
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat + age, data) %>%
pluck("fit") -> mlr
mlr %>% summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat, data[-c(outliers,highlevgs),]) %>%
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat + age, data) %>%
pluck("fit") -> mlr
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat + age, data) %>%
pluck("fit") -> mlr
mlr %>% summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat , data) %>%
pluck("fit") -> mlr
mlr %>% summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat + age, data) %>%
pluck("fit") -> mlr
mlr %>% summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat + age, data) %>%
pluck("fit") %>%
summary()
linaer_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mevd~.)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mevd~.)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mevd~., data)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv~., data)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv~., data) %>%
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv~., data) %>%
pluck("fit") -> mlr
mlr %>% summary()
mlr %>% car::vif()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv~., data) %>%
pluck("fit") -> mlr
mlr %>% summary()
mlr %>% car::vif()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv~. -tax, data) %>%
pluck("fit") -> mlr
mlr %>% summary()
mlr %>% car::vif()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv~., data) %>%
pluck("fit") -> mlr
mlr %>% summary()
mlr %>% car::vif()
mlr %>% summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv~. - age, data) %>%
pluck("fit")
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv~. - age, data) %>%
pluck("fit") %>%
summary()
mlr %>% summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv~. - age, data) %>%
pluck("fit") %>%
summary()
mlr %>% summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv~. - age, data) %>%
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv~., data) %>%
pluck("fit") -> mlr
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv~., data) %>%
pluck("fit") -> mlr
mlr %>% summary()
mlr %>% summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv~. - age, data) %>%
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat * age, data) %>%
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat * age, data) %>%  # short for fit(medv~ lstat + age + lstat * age)
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat + I(lstat^2), data) %>%
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat + I(lstat^2) + age, data) %>%
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat + I(lstat^2), data) %>%
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat + I(lstat^2), data) %>%
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat + I(lstat^2), data) %>%
pluck("fit") %>%
summary() %>%
anova()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat + I(lstat^2), data) %>%
pluck("fit") %>%
anova()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat + I(lstat^2), data) %>%
pluck("fit") -> modelQuad
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat, data) %>%
pluck("fit") -> modelLin
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat + I(lstat^2), data) %>%
pluck("fit") -> modelQuad
anova(modelLin, modelQuad)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat, data) %>%
pluck("fit")
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat, data) %>%
pluck("fit") %>%
augment()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat, data) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x = .fitted, y =.std.resid) + geom_point()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat, data) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x = .fitted, y =.resid) + geom_point()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat, data) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x = .fitted, y =.resid) + geom_point() + geom_smooth(se =F)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat, data) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x = .fitted, y =.resid) + geom_point() + geom_smooth(se =F) + ggtitle("Linear model residual plot")
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat + I(lstat^2), data) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x = .fitted, y =.resid) + geom_point() + geom_smooth(se =F) + ggtitle("Linear model residual plot")
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat, data) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x = .fitted, y =.resid) + geom_point() + geom_smooth(se =F) + ggtitle("Linear model residual plot") -> p1
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ lstat + I(lstat^2), data) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x = .fitted, y =.resid) + geom_point() + geom_smooth(se =F) + ggtitle("Quadratic model residual plot") -> p2
p1 + p2
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ poly(lstat,10))
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ poly(lstat,10),data)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ poly(lstat,10),data) %>%
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ poly(lstat,5),data) %>%
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ poly(lstat,10),data) %>%
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ poly(lstat,5),data) %>%
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ poly(lstat,5),data) %>%
pluck("fit") %>%
augment()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ poly(lstat,5),data) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x = .fitted, y =.resid) + geom_point() + geom_smooth(se =F) + ggtitle("Quadratic model residual plot")
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ poly(lstat,5),data) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x = .fitted, y =.resid) + geom_point() + geom_smooth(se =F) + ggtitle("poly 5 model residual plot")
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ poly(lstat,5),data) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x = .fitted, y =.resid) + geom_point() + geom_smooth(se =F) + ggtitle("poly 5 model residual plot")  -> p3
p1 + p2 + p3
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ log(lstat),data) %>%
pluck("fit")
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ log(lstat),data) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x = .fitted, y =.resid) + geom_point() + geom_smooth(se =F) + ggtitle("poly 5 model residual plot")
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ log(lstat),data) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x = .fitted, y =.resid) + geom_point() + geom_smooth(se =F) + ggtitle("log model residual plot")
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ log(rm),data) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x = .fitted, y =.resid) + geom_point() + geom_smooth(se =F) + ggtitle("log model residual plot")
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ log(rm),data) %>%
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ log(lstat),data) %>%
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ poly(lstat,5),data) %>%
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ log(lstat),data) %>%
pluck("fit") %>%
summary()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ log(lstat),data) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x = .fitted, y =.resid) + geom_point() + geom_smooth(se =F) + ggtitle("log model residual plot")
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(medv ~ log(rm),data) %>%
pluck("fit") %>%
summary()
