lm(default~balance,.) -> lm_res
default %>%
mutate(default = ifelse(default == "Yes",1,0)) %>%
ggplot() + aes(x = balance, y = default) + geom_point(shape = 4, color = "brown4") +
geom_abline(intercept = lm_res$coefficients[1], slope = lm_res$coefficients[2], color = "blue") + scale_y_continuous(expand = c(0,0.25), breaks = seq(-0.2,1,by=0.2) )
default %>%
mutate(default = ifelse(default == "Yes",1,0)) %>%
lm(default~balance,.) -> lm_res
default %>%
mutate(default = ifelse(default == "Yes",1,0)) %>%
ggplot() + aes(x = balance, y = default) + geom_point(shape = 4, color = "brown4") +
geom_abline(intercept = lm_res$coefficients[1], slope = lm_res$coefficients[2], color = "blue") + scale_y_continuous(expand = c(0,0.25), breaks = seq(-0.2,1,by=0.2) )
default %>%
mutate(default = ifelse(default == "Yes",1,0)) %>%
print() %>%
lm(default~balance,.) %>%
summary()
lm_res
recepie()
recipe(default~balance, data = default)
rec <- recipe(default~balance, data = default)
logistic_reg() %>%
set_engine("glm") -> model
workflow() %>%
add_model()
workflow() %>%
add_model() %>%
add_recipe(rec)
workflow() %>%
add_model(model) %>%
add_recipe(rec)
workflow() %>%
add_model(model) %>%
add_recipe(rec) %>%
fit(data= default)
workflow() %>%
add_model(model) %>%
add_recipe(rec) %>%
fit(data= default) %>%
tidy()
workflow() %>%
add_model(model) %>%
add_recipe(rec) %>%
fit(data= default) %>%
summary()
workflow() %>%
add_model(model) %>%
add_recipe(rec) %>%
fit(data= default) %>%
tidy()
workflow() %>%
add_model(model) %>%
add_recipe(rec) %>%
fit(data= default) %>%
glance()
$$
default
logistic_reg() %>%
set_engine("glm") %>%
set_mode("classification")
logistic_reg() %>%
set_engine("glm") %>%
set_mode("classification") -> log_model
log_model
default
recipe(default ~ balance, data = default)
default_recepie <- recipe(default ~ balance, data = default)
default_recepie
# setup the recipe
default_recipe <- recipe(default ~ balance, data = default)
default_recipe
# set up the workflow
workflow() %>%
add_model(log_model) %>%
add_recipe(default_recipe)
# set up the workflow
workflow() %>%
add_model(log_model) %>%
add_recipe(default_recipe) -> default_workflow
default_workflow
## fit model
fit() %>% default_workflow
# set up the workflow
workflow() %>%
add_model(log_model) %>%
add_recipe(default_recipe) -> default_workflow
default_workflow
## fit model
fit() %>% default_workflow
## fit model
default_workflow %>%
fit(data = default)
## fit model
default_workflow %>%
fit(data = default) %>%
glimpse()
## fit model
default_workflow %>%
fit(data = default) %>%
pluck("fit")
## fit model
default_workflow %>%
fit(data = default) %>%
pluck("fit") %>%
summary()
## fit model
default_workflow %>%
fit(data = default) %>%
pluck("fit") %>%
tidy()
## fit model
default_workflow %>%
fit(data = default) %>%
pluck("fit") %>%
augment()
## fit model
default_workflow %>%
fit(data = default) %>%
summary()
## fit model
default_workflow %>%
fit(data = default) %>%
tidy()
## fit model
default_workflow %>%
fit(data = default) %>%
tidy(exponentiate = T)
## fit model
default_workflow %>%
fit(data = default) %>%
tidy(exponentiate = T, conf.int = T)
## fit model
default_workflow %>%
fit(data = default) %>%
augment()
## fit model
default_workflow %>%
fit(data = default) %>%
augment()
## fit model
default_workflow %>%
fit(data = default) %>%
augment(newdata = default)
## fit model
default_workflow %>%
fit(data = default) %>%
augment(new_data = default)
## fit model
default_workflow %>%
fit(data = default) %>%
augment(new_data = default) %>% sample_n(10)
## fit model
default_workflow %>%
fit(data = default) %>%
summary()
## fit model
default_workflow %>%
fit(data = default) %>%
tidy()
default_workflow %>%
fit(data = default)
default_workflow %>%
fit(data = default) %>%
tidy()
default_workflow %>%
fit(data = default) %>%
augment()
default_workflow %>%
fit(data = default) %>%
augment(new_data = default)
default_workflow %>%
fit(data = default) %>%
augment(new_data = default) %>%
ggplot() + aes(x = balance, y = default) + geom_point()
default_workflow %>%
fit(data = default) %>%
augment(new_data = default) %>%
ggplot() + aes(x = balance, y = default, color = .pred_class) + geom_point()
default_workflow %>%
fit(data = default) %>%
augment(new_data = default) %>%
ggplot() + aes(x = balance, y = default, color = .pred_class) + geom_point() + scale_color_ipsum()
default_workflow %>%
fit(data = default) %>%
augment(new_data = default)
default_workflow %>%
fit(data = default) %>%
augment(new_data = default) %>%
ggplot() + aes(x = balance, y = default, color = .pred_class) + geom_point() + scale_color_ipsum()
default_workflow %>%
fit(data = default) %>%
augment(new_data = default)
default_workflow %>%
fit(data = default) %>%
augment(new_data = default, conf_int = T)
default_workflow %>%
fit(data = default) %>%
augment(new_data = default, conf.nt = T)
default_workflow %>%
fit(data = default) %>%
augment(new_data = default, conf.int = T)
default_workflow %>%
fit(data = default) %>%
augment(new_data = default, conf.int = T)
## fit model
default_workflow %>%
fit(data = default) %>%
tidy()
## fit model
default_workflow %>%
fit(data = default) %>%
tidy(conf.int = T)
## fit model
default_workflow %>%
fit(data = default) %>%
tidy(conf.int = T)
-10.7/0.361
default
## fit model
default_workflow %>%
fit(data = default) %>%
tidy(conf.int = T)
0.00550* 37469 - 10.7
e^2
exp(195)
exp(195)/(1-exp(195))
## fit model
default_workflow %>%
fit(data = default) %>%
tidy(conf.int = T)
exp(195)/(1+exp(195))
default_workflow %>%
fit(data = default) %>%
augment(new_data = default, conf.int = T)
default_workflow %>%
fit(data = default) %>%
augment(new_data = default, conf.int = T)
default
## fit model
default_workflow %>%
fit(data = default) %>%
tidy(conf.int = T)
default
default %>%
mutate(
px = exp(-10.6513 + 0.0055 * balance) / (1 + exp(-10.6513 + 0.0055 * balance))
)
default_workflow %>%
fit(data = default) %>%
augment(new_data = default, conf.int = T)
default %>%
mutate(
px = exp(-10.6513 + 0.0055 * balance) / (1 + exp(-10.6513 + 0.0055 * balance))
)
default %>%
mutate(
px = exp(-10.6513 + 0.0055 * balance) / (1 + exp(-10.6513 + 0.0055 * balance))
)
default %>%
mutate(
predicted_yes = exp(-10.6513 + 0.0055 * balance) / (1 + exp(-10.6513 + 0.0055 * balance))
)
default %>%
mutate(
pred.prob.yes = exp(-10.6513 + 0.0055 * balance) / (1 + exp(-10.6513 + 0.0055 * balance))
)
exp(-10.6513 + 0.0055 * 1000) / (1 + exp(-10.6513 + 0.0055 * 1000)
exp(-10.6513 + 0.0055 * 1000) / (1 + exp(-10.6513 + 0.0055 * 1000)
exp(-10.6513 + 0.0055 * 1000) / (1 + exp(-10.6513 + 0.0055 * 1000))
exp(-10.6513 + 0.0055 * 1000) / (1 + exp(-10.6513 + 0.0055 * 1000))
exp(-10.6513 + 0.0055 * 2000) / (1 + exp(-10.6513 + 0.0055 * 2000))
default_workflow %>%
fit(new_data=default)
default_workflow %>%
fit(data=default)
default_workflow %>%
fit(data=default) %>%
tidy()
default_workflow %>%
fit(data=default) %>%
augment(new_data = default)
default_workflow %>%
fit(data=default) %>%
augment(new_data = default) %>% sample_n(10)
default_workflow %>%
fit(data=default) %>%
augment(new_data = default) %>% sample_n(10)
default_workflow %>%
fit(data=default) %>%
augment(new_data = default) %>% sample_n(10)
default_workflow %>%
fit(data=default) %>%
augment(new_data = default) %>% sample_n(10)
?sample_n
default_workflow %>%
fit(data=default) %>%
augment(new_data = default) %>% slice_sample(10)
default_workflow %>%
fit(data=default) %>%
augment(new_data = default) %>% slice_sample(n =10)
default_workflow %>%
fit(data=default) %>%
augment(new_data = default) %>% slice_sample(n =10)
default_workflow %>%
fit(data=default) %>%
augment(new_data = default) %>% slice_sample(n =10)
set.seed(10)
default_workflow %>%
fit(data=default) %>%
augment(new_data = default) %>% slice_sample(n =10)
set.seed(102)
default_workflow %>%
fit(data=default) %>%
augment(new_data = default) %>% slice_sample(n =10)
set.seed(1022)
default_workflow %>%
fit(data=default) %>%
augment(new_data = default) %>% slice_sample(n =10)
set.seed(10223)
default_workflow %>%
fit(data=default) %>%
augment(new_data = default) %>% slice_sample(n =10)
set.seed(102232)
default_workflow %>%
fit(data=default) %>%
augment(new_data = default) %>% slice_sample(n =10)
set.seed(10223231)
default_workflow %>%
fit(data=default) %>%
augment(new_data = default) %>% slice_sample(n =10)
set.seed(102232331)
default_workflow %>%
fit(data=default) %>%
augment(new_data = default) %>% slice_sample(n =10)
set.seed(1)
default_workflow %>%
fit(data=default) %>%
augment(new_data = default) %>% slice_sample(n =10)
default_workflow %>%
fit(data=default) %>%
augment(new_data = default)
set.seed(14)
default_workflow %>%
fit(data=default) %>%
augment(new_data = default)
default_workflow %>%
fit(data=default) %>%
augment(new_data = default)
default_workflow %>%
fit(data=default) %>%
augment(new_data = default) %>% print()
default_workflow %>%
fit(data=default) %>%
augment(new_data = default) %>% print() %>%
count(.pred_class)
# originally
default
# originally
default %>%
count(default)
logistic_reg() %>%
set_mode("glm") %>%
set_engine("lm")
logistic_reg() %>%
set_engine("glm") %>%
set_mode("lm")
logistic_reg() %>%
set_engine("glm") %>%
set_mode("logistic")
logistic_reg() %>%
set_engine("glm") %>%
set_mode("classification")
logistic_reg() %>%
set_engine("glm") %>%
set_mode("classification") -> log_model
default_recepie <- recipe(default ~ student)
default_recepie <- recipe(default ~ student, data = default)
logistic_reg() %>%
set_engine("glm") %>%
set_mode("classification") -> log_model
default_recipe <- recipe(default ~ student, data = default)
workflow() %>%
add_model(log_model) %>%
add_recipe(default_recipe) -> default_workflow
default_workflow %>%
fit(data = default)
default_workflow %>%
fit(data = default) %>%
tidy(conf.int = T)
default_workflow %>%
fit(data = default) %>%
augment(new_data = default)
default_workflow %>%
fit(data = default) %>%
augment(new_data = default) %>%
count(student,default)
default_workflow %>%
fit(data = default) %>%
augment(new_data = default) %>%
count(student,.pred_class)
default %>%
group_by(student, default) %>%
count(n())
default %>%
group_by(student, default) %>%
summary(count = n())
default %>%
group_by(student, default) %>%
summarise(count = n())
default_workflow %>%
fit(data = default) %>%
augment(new_data = default) %>%
count(student,.pred_class)
default %>%
group_by(student, default) %>%
summarise(count = n())
default_workflow %>%
fit(data = default) %>%
augment(new_data = default) %>%
count(student,.pred_class)
default %>%
group_by(student, default) %>%
summarise(count = n())
default %>%
group_by(student) %>%
summarise(count = n())
default %>%
group_by(student,default) %>%
summarise(count = n())
default_workflow %>%
fit(data = default) %>%
augment(new_data = default) %>%
count(student,.pred_class)
default %>%
group_by(student,default) %>%
summarise(count = n())
default_workflow %>%
fit(data = default) %>%
augment(new_data = default) %>%
count(student,.pred_class)
default_workflow %>%
fit(data = default) %>%
augment(new_data = default)
default_workflow %>%
fit(data = default) %>%
augment(new_data = default) %>% count(.pred_class)
default_workflow %>%
fit(data = default) %>%
augment(new_data = default)
logistic_reg() %>%
set_mode("glm") %>%
set_engine("classification")
logistic_reg() %>%
set_engine("glm") %>%
set_mode("classification")
logistic_reg() %>%
set_engine("glm") %>%
set_mode("classification") -> log_model
default
recipe(default ~ balance + income + student, data = default)
recipe(default ~ balance + income + student, data = default) -> default_recipe
workflow() %>%
add_model(log_model) %>%
add_recipe(default_recipe)
workflow() %>%
add_model(log_model) %>%
add_recipe(default_recipe) -> default_workflow
default_workflow %>%
fit()
default_workflow %>%
fit(data = default)
default_workflow %>%
fit(data = default) %>%
tidy(conf.int = T)
default_workflow %>%
fit(data = default) %>%
tidy()
default_workflow %>%
fit(data = default)
default_workflow %>%
fit(data = default) %>%
tidy()
default_workflow %>%
fit(data = default) %>%
tidy() %>%
pluck("estimate")
default_workflow %>%
fit(data = default) %>%
tidy() %>%
pluck("estimate")[3]
default_workflow %>%
fit(data = default) %>%
tidy() %>%
pluck("estimate")[2]
default_workflow %>%
fit(data = default) %>%
tidy() %>%
pluck("estimate")
default_workflow %>%
fit(data = default) %>%
tidy() %>%
pull("estimate")
default_workflow %>%
fit(data = default) %>%
tidy() %>%
pull("estimate") %>%
.[3]
default_workflow %>%
fit(data = default) %>%
tidy() %>%
pull("estimate") %>%
.[3] * 1000
