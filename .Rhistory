y_hat = beta_0_hat_data + beta_1_hat_data * x
) -> data
# Chunk 32
RSS_data = sum((data$y - data$y_hat)^2)
RSS_data
# Chunk 33
RSE_data = sqrt((RSS_data/(length(data$y) -2)))
RSE_data
# Chunk 34
se_beta_0_data = sqrt(((1/length(data$y)) + (mean(data$x)^2 / sum((data$x - mean(data$x))^2))) * RSE_data^2)
se_beta_0_data
# Chunk 35
se_beta_1_data = sqrt(RSE_data^2 / (sum((data$x - mean(data$x))^2)))
se_beta_1_data
# Chunk 36
summary(lm(y~x,data))
# Chunk 37
cat("By 95% confidence we can say that the true beta_0 is between", beta_0_hat_data - 1.96 * se_beta_0_data, "and", beta_0_hat_data + 1.96 * se_beta_0_data )
# Chunk 38
cat("By 95% confidence we can say that the true beta_0 is between", beta_1_hat_data - 1.96 * se_beta_1_data, "and", beta_1_hat_data + 1.96 * se_beta_1_data)
# Chunk 39
confint(lm(y~x,data))
# Chunk 40
summary(lm(sales ~ TV, advertising))
# Chunk 41
advertising %>%
mutate(sales_hat = beta_0_hat_adv + beta_1_hat_adv * TV) -> advertising
advertising
# Chunk 42
RSS = sum((advertising$sales - advertising$sales_hat)^2)
RSS
# Chunk 43
RSE = sqrt(RSS/(length(advertising$sales) -2))
RSE
# Chunk 44
TSS = sum((advertising$sales - mean(advertising$sales))^2)
TSS
# Chunk 45
R2 = (TSS - RSS) / TSS
R2
# Chunk 46
data
# Chunk 47
RSS_data = sum((data$y - data$y_hat)^2)
RSS_data
# Chunk 48
RSE_data = sqrt(RSS_data/(length(data$y) -2))
RSE_data
# Chunk 49
TSS_data = sum((data$y - mean(data$y))^2)
TSS_data
# Chunk 50
R2_data = (TSS_data - RSS_data) / TSS_data
R2_data
# Chunk 51
summary(lm(sales ~ TV, advertising))
# Chunk 52
summary(lm(sales ~ radio, advertising))
# Chunk 53
summary(lm(sales ~ newspaper, advertising))
# Chunk 54
summary(lm(sales ~ TV + radio + newspaper, advertising))
# Chunk 55
confint(lm(sales ~ TV + radio + newspaper, advertising))
# Chunk 56
cor(advertising[1:4])
# Chunk 57
corrplot(cor(advertising[1:4]), method = "number")
# Chunk 58
summary(lm(sales ~ TV + radio + newspaper, advertising))
# Chunk 59
summary(lm(sales ~ TV + radio + newspaper, advertising))
# Chunk 60
summary(lm(sales ~ TV + radio, advertising))
# Chunk 61
summary(lm(sales ~ TV, advertising))
# Chunk 62
summary(lm(sales ~ TV + radio, advertising))
# Chunk 63
summary(lm(sales ~ TV + newspaper, advertising))
# Chunk 64
summary(lm(sales ~ radio, advertising))
# Chunk 65
summary(lm(sales~radio+TV, advertising))
# Chunk 66
summary(lm(sales ~ radio + newspaper, advertising))
# Chunk 67
summary(lm(sales ~ TV + radio, advertising))
# Chunk 68
summary(lm(sales ~ TV + radio + newspaper, advertising))
# Chunk 69
Credit = read.csv("./data/Credit.csv") %>% as_tibble
Credit
# Chunk 70
#| fig-cap: Fig 3.6 The credit data set contains infortmation about blaance, age, cards, education income, limit and rating for a number of potential customers
Credit %>% select(where(is.numeric)) %>% pairs(.)
# Chunk 71
Credit$Gender <- factor(Credit$Gender, levels = c(" Male","Female"))
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(Balance ~ Gender, Credit) %>%
pluck("fit") %>%
summary()
# Chunk 72
Credit %>%
mutate(Gender = as.character(Gender)) %>%
mutate(Gender = ifelse(Gender == "Female",1,0)) %>%
lm(Balance ~ Gender, .) %>%
summary()
# Chunk 73
Credit %>%
ggplot() + aes(x=Gender, y =Balance, fill = Gender) + geom_boxplot(show.legend = F) + geom_point(data =(Credit %>% group_by(Gender) %>% summarise(Balance = mean(Balance))),shape = 4, show.legend = F) + theme_clean()
# Chunk 74
Credit %>%
mutate(Gender = factor(Gender, levels = c("Female", " Male"))) %>%
lm(Balance ~ Gender,.) %>%
summary()
# Chunk 75
Credit %>%
mutate(Gender = as.character(Gender)) %>%
mutate(Gender = ifelse(Gender == "Female",1,-1)) %>%
lm(Balance ~ Gender,.) %>%
summary()
# Chunk 76
Credit %>% select(Ethnicity) %>% unique()
# Chunk 77
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(Balance ~ Ethnicity, Credit) %>%
pluck("fit") %>%
summary()
# Chunk 78
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(sales ~ TV + radio + TV*radio, advertising) %>%
pluck("fit") %>%
summary()
# Chunk 79
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(Balance ~ Income + Student, Credit) %>%
pluck("fit") %>%
summary()
# Chunk 80
#| warning: false
Credit %>%
ggplot() + aes(y=Balance, x=Income) + geom_point(shape =NA) + geom_abline(intercept = 211.1430, slope = 5.9843, color = "black", size=1.2) + geom_abline(intercept = 593.8135, slope = 5.9843, color = "darkred", size= 1.2) + coord_cartesian(xlim = c(0,150), ylim=c(200,1400)) + scale_y_continuous(breaks = seq(0,1400,400)) + theme_clean() + geom_text(data = tibble(x = c(80,80), y =c(1130,640), z = c("Student","non-student")), inherit.aes = F, aes(x=x, y=y, label=z), angle=25.9) -> p1
p1
# Chunk 81
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(Balance ~ Income + Student + Income * Student, Credit) %>%
pluck("fit") %>%
summary()
# Chunk 82
tibble(
intercept = c(200.6232, 200.6232+476.6758),
income = c(6.2182, 6.2182 - 1.9992),
type = c("Non-student", "student")
)
# Chunk 83
#| warning: false
Credit %>%
ggplot() + aes(x = Income, y = Balance) + geom_point(shape =NA)+
geom_abline(intercept = 201, slope = 6.22, color = "black", size =1.2) +
geom_abline(intercept = 677, slope = 4.22, size = 1.2, color = "darkred") +  coord_cartesian(xlim = c(0,150), ylim=c(200,1400)) + scale_y_continuous(breaks = seq(0,1400,400)) + theme_clean() + geom_text(data = tibble(x = c(80,80), y =c(1130,640), z = c("Student","non-student")), inherit.aes = F, aes(x=x, y=y, label=z), angle=25.9) -> p2
p2
# Chunk 84
#| warning: false
gridExtra::grid.arrange(p1,p2, ncol =2)
# Chunk 85
#| fig-cap: linear regresion fit is in orange, blue curve is a linear regression fit for a model that includes horsepower^2, and green curve includes up to horsepower^5
Auto %>% as_tibble() %>%
ggplot() + aes(x=horsepower, y = mpg) + geom_point(shape =1, size =1.4) +
geom_smooth(method = "lm", se = F, color ="#FEBF63") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), color ="#7FDBDA", se = F) +
geom_smooth(method = "lm", formula = y ~ poly(x,5), color ="#ADE498", se=F) + theme_blank()
# Chunk 86
Auto %>%
mutate(hp.sq = horsepower^2) %>%
lm(mpg~horsepower + hp.sq,.) %>%
summary()
# Chunk 87
summary(lm(mpg ~ horsepower + I(horsepower^2), Auto))
# Chunk 88
summary(lm(mpg ~ poly(horsepower,2, raw=T), Auto))
# Chunk 89
summary(nls(mpg ~a + b * horsepower + c * horsepower^2, data = Auto, start = c(a=0,b=0,c=0)))
# Chunk 90
summary(lm(mpg ~ horsepower, Auto))
# Chunk 91
summary(lm(mpg ~ horsepower + I(horsepower^2),Auto))
# Chunk 92
summary(lm(horsepower ~ poly(horsepower,5, raw=T),Auto))
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto) %>%
pluck("fit")
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto) %>%
pluck("fit") %>%
tidy()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto) %>%
augment()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto) %>%
pluck("fit") %>%
augment()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=horesepower, y = .resid) + geom_point()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=horsepower, y = .resid) + geom_point()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=horsepower, y = .resid) + geom_point() + geom_smooth()
gridExtra::grid.arrange(
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y=.resid) + geom_point() + geom_smooth(se=F) + geom_hline(yintercept = 0, linetype = "dashed") + theme_minimal()
,
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower + I(horsepower^2), Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y=.resid) + geom_point() + geom_smooth(se=F) + geom_hline(yintercept = 0, linetype = "dashed") + theme_minimal(), ncol=2)
gridExtra::grid.arrange(
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y=.resid) + geom_point() + geom_smooth(se=F) + geom_hline(yintercept = 0, linetype = "dashed") + theme_minimal()
,
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower + I(horsepower^2), Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y=.resid) + geom_point() + geom_smooth(se=F) + geom_hline(yintercept = 0, linetype = "dashed") + theme_minimal(), ncol=2)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=horsepower, y = .resid) + geom_point() + geom_smooth()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=horsepower, y = .resid) + geom_point() + geom_smooth(se=F)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=horsepower, y = .resid) + geom_point() + geom_smooth(se=F) + theme_clean()
gridExtra::grid.arrange(
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y=.resid) + geom_point() + geom_smooth(se=F) + geom_hline(yintercept = 0, linetype = "dashed") + theme_minimal()
,
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower + I(horsepower^2), Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y=.resid) + geom_point() + geom_smooth(se=F) + geom_hline(yintercept = 0, linetype = "dashed") + theme_minimal(), ncol=2)
gridExtra::grid.arrange(
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y=.resid) + geom_point() + geom_smooth(se=F) + geom_hline(yintercept = 0, linetype = "dashed") + theme_minimal()
,
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower + I(horsepower^2), Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y=.resid) + geom_point() + geom_smooth(se=F) + geom_hline(yintercept = 0, linetype = "dashed") + theme_minimal(), ncol=2)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=horsepower, y = .resid) + geom_point() + geom_smooth(se=F) + theme_clean()
gridExtra::grid.arrange(
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y=.resid) + geom_point() + geom_smooth(se=F) + geom_hline(yintercept = 0, linetype = "dashed") + theme_light()
,
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower + I(horsepower^2), Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y=.resid) + geom_point() + geom_smooth(se=F) + geom_hline(yintercept = 0, linetype = "dashed") + theme_minimal(), ncol=2)
gridExtra::grid.arrange(
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y=.resid) + geom_point() + geom_smooth(se=F) + geom_hline(yintercept = 0, linetype = "dashed") + theme_light()
,
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower + I(horsepower^2), Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y=.resid) + geom_point() + geom_smooth(se=F) + geom_hline(yintercept = 0, linetype = "dashed") + theme_light, ncol=2)
gridExtra::grid.arrange(
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y=.resid) + geom_point() + geom_smooth(se=F) + geom_hline(yintercept = 0, linetype = "dashed") + theme_light()
,
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower + I(horsepower^2), Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y=.resid) + geom_point() + geom_smooth(se=F) + geom_hline(yintercept = 0, linetype = "dashed") + theme_light(), ncol=2)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=horsepower, y = .resid) + geom_point() + geom_smooth(se=F) + theme_light()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower + I(horsepower^2), Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y=.resid) + geom_point() + geom_smooth(se=F) + geom_hline(yintercept = 0, linetype = "dashed") + theme_light(), ncol=2)
gridExtra::grid.arrange(
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y=.resid) + geom_point() + geom_smooth(se=F) + geom_hline(yintercept = 0, linetype = "dashed") + theme_light()
,
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower + I(horsepower^2), Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y=.resid) + geom_point() + geom_smooth(se=F) + geom_hline(yintercept = 0, linetype = "dashed") + theme_light(), ncol=2)
linear_reg() %>%
set_mode("regression ") %>%
set_engine("lm") %>%
fit(sales ~ TV + radio, advertising)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(sales ~ TV + radio, advertising)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(sales ~ TV + radio, advertising) %>%
pluck("fit") %>%
augment()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(sales ~ TV + radio, advertising) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y = .resid) + geom_point()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(sales ~ TV + radio, advertising) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y = .resid) + geom_point() + geom_smooth()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(sales ~ TV + radio, advertising) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y = .resid) + geom_point() + geom_smooth(se = F)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(sales ~ TV + radio + TV * radio, advertising) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y = .resid) + geom_point() + geom_smooth(se = F)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(sales ~ TV , advertising) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y = .resid) + geom_point() + geom_smooth(se = F)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(sales ~ TV + radio + TV * radio, advertising) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y = .resid) + geom_point() + geom_smooth(se = F)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(sales ~ TV + radio + TV * radio, advertising) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y = .resid) + geom_point() + geom_smooth(method = "lm",se = F)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(sales ~ TV + radio , advertising) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y = .resid) + geom_point() + geom_smooth(method = "lm",se = F)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(sales ~ TV  , advertising) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y = .resid) + geom_point() + geom_smooth(method = "lm",se = F)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto)
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto) %>%
pluck("fit") %>%
augment()
linear_reg() %>%
set_mode("regression") %>%
set_engine("lm") %>%
fit(mpg ~ horsepower, Auto) %>%
pluck("fit") %>%
augment() %>%
ggplot() + aes(x=.fitted, y = .resid) + geom_point()
plot(lm(mpg~horsepower, Auto))
![](fig3.12.png)
